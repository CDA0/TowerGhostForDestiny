<!DOCTYPE html>
<html>
  <head>
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />	
    <title>Destiny Item Viewer</title>

    <!-- Viewport mobile tag for sensible mobile support -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="style.css">

	<script type="text/javascript" src="scripts/bungie.js"></script>
    <script src="/js/dependencies/jquery.js"></script>
    <script src="/js/dependencies/knockout.js"></script>
    <script src="/js/dependencies/underscore-min.js"></script>
    <script src="/js/app.js"></script>

  </head>

  <body>
		<script type="text/html" id="sections-template">
			<div class="title" data-bind="text: list.split('.')[1]"></div>
			<div class="row">
				<div style="width: 52px; display: inline-block; vertical-align:top;" data-bind="visible: character.id != 'Vault'">
					<span class="item" data-bind="with: character.itemEquipped(list.split('.')[0], list.split('.')[1])">
						<img data-bind="attr: { src: icon }, click: toggleMove">
						<div class="move-popup" data-bind="visible: doMove">
						  <div class="item-name" data-bind="text: description"></div>
						  <div class="locations" data-bind="foreach: { data: $root.orderedCharacters, as: 'character' }">
							<div class="move-button" style="display: block;" data-bind="visible: character.id == 'Vault'">
								<span>vault</span>								
							</div>
							<div class="move-button" style="display: block;" data-bind="style: { backgroundImage: icon }, visible: character.id !== 'Vault'">
								<span>store</span>								
							</div>
							<div class="move-button" style="display: block;" data-bind="style: { backgroundImage: icon }, visible: $parent.characterId != character.id && character.id !== 'Vault'">
								<span>equip</span>								
							</div>								
						  </div>
						</div>
					</span>
				</div>
				<div style="width: 205px; display: inline-block;">
					<div class="item-Section" data-bind="foreach: { data: character.get(list.split('.')[0], list.split('.')[1]), as: 'item' }">								
						<span class="item">
							<img data-bind="attr: { src: item.icon }, click: toggleMove">
							<div class="move-popup" data-bind="visible: doMove">
							  <div class="item-name" data-bind="text: description"></div>
							  <div class="locations" data-bind="foreach: { data: $root.orderedCharacters, as: 'avatar' }">
								<div class="move-button" style="display: block;" data-bind="click: function(){ item.store(list.split('.')[0], avatar.id) }, visible: avatar.id == 'Vault' && character.id !== 'Vault'">
									<span>vault</span>								
								</div>
								<div class="move-button" style="display: block;" data-bind="click: function(){ item.store(list.split('.')[0], avatar.id) }, style: { backgroundImage: icon }, visible: item.characterId != avatar.id && avatar.id !== 'Vault'">
									<span>store</span>								
								</div>
								<div class="move-button" style="display: block;" data-bind="click: function(){ item.equip(list.split('.')[0], avatar.id) }, style: { backgroundImage: icon }, visible: !item.isEquipped && avatar.id !== 'Vault'">
									<span>equip</span>								
								</div>								
							  </div>
							</div>
						</span>
					</div>
				</div>
			</div>	
		</script>
  		<div class="content" id="storage" data-bind="foreach: { data: orderedCharacters, as: 'character' }">
			<div class="storage">
				<div class="character">
				  <div class="character-box" data-bind="style: { backgroundImage: background }">
					<div class="emblem" data-bind="style: { backgroundImage: icon }"></div>
					<div class="class" data-bind="text: classType"></div>
					<div class="level" data-bind="text: level" style="color: rgb(245, 220, 86)"></div>
				  </div>				
				</div>
				<div>
					<div class="items" data-type="item">
					  <div>
						<div class="title">Weapons (<span data-bind="text: character.weapons().length"></span>)</div>
						<div class="item-Weapon sections" data-bind="template: { name: 'sections-template', foreach: ['weapons.Primary','weapons.Special','weapons.Heavy'], as: 'list' }">
						</div>
					  </div>
					  <div>
						<div class="title">Armor</div>
						<div class="item-Armor sections" data-bind="template: { name: 'sections-template', foreach: ['armor.Helmet','armor.Gauntlet','armor.Chest', 'armor.Boots'], as: 'list' }">
						</div>
					  </div>
					  <div>
						<div class="title">Styling</div>
						<div class="item-Styling sections" data-bind="template: { name: 'sections-template', foreach: ['items.Shader','items.Emblem','items.Ship','items.Sparrow'], as: 'list' }">							
						</div>
					  </div>
					</div>
				</div>
			</div>
		</div>
  </body>
</html>
