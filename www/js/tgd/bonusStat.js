tgd.infusionStats = {
    errorFactor: {
        200: 0.166667,
        201: 0.25,
        202: 0.25,
        203: 0.0454545,
        204: 0.0454545,
        205: 0.0454545,
        206: 0.0454545,
        207: 0.0454545,
        208: 0.0454545,
        209: 0.0454545,
        210: 0.0454545,
        211: 0.0454545,
        212: 0.0454545,
        213: 0.0454545,
        214: 0.0833333,
        215: 0.0833333,
        216: 0.0833333,
        217: 0.0833333,
        218: 0.0833333,
        219: 0.0833333,
        220: 0.1,
        221: 0.1,
        222: 0.1,
        223: 0.1,
        224: 0.1,
        225: 0.0833333,
        226: 0.0833333,
        227: 0.0833333,
        228: 0.0833333,
        229: 0.0833333,
        230: 0.0833333,
        231: 0.1,
        232: 0.1,
        233: 0.1,
        234: 0.1,
        235: 0.1,
        236: 0.1,
        237: 0.1,
        238: 0.1,
        239: 0.1,
        240: 0.1,
        241: 0.1,
        242: 0.1,
        243: 0.1,
        244: 0.1,
        245: 0.1,
        246: 0.0714286,
        247: 0.0714286,
        248: 0.0714286,
        249: 0.0714286,
        250: 0.0714286,
        251: 0.0714286,
        252: 0.0714286,
        253: 0.1,
        254: 0.1,
        255: 0.1,
        256: 0.1,
        257: 0.1,
        258: 0.0833333,
        259: 0.0833333,
        260: 0.0833333,
        261: 0.0833333,
        262: 0.0833333,
        263: 0.0833333,
        264: 0.1,
        265: 0.1,
        266: 0.1,
        267: 0.1,
        268: 0.1,
        269: 0.0833333,
        270: 0.0833333,
        271: 0.0833333,
        272: 0.0833333,
        273: 0.0833333,
        274: 0.0833333,
        275: 0.1,
        276: 0.1,
        277: 0.1,
        278: 0.1,
        279: 0.1,
        280: 0.0833333,
        281: 0.0833333,
        282: 0.0833333,
        283: 0.0833333,
        284: 0.0833333,
        285: 0.0833333,
        286: 0.1,
        287: 0.1,
        288: 0.1,
        289: 0.1,
        290: 0.1,
        291: 0.0833333,
        292: 0.0833333,
        293: 0.0833333,
        294: 0.0833333,
        295: 0.0833333,
        296: 0.0833333,
        297: 0.125,
        298: 0.125,
        299: 0.125,
        300: 0.125,
        301: 0.1,
        302: 0.1,
        303: 0.1,
        304: 0.1,
        305: 0.1,
        306: 0.125,
        307: 0.125,
        308: 0.125,
        309: 0.125,
        310: 0.125,
        311: 0.125,
        312: 0.125,
        313: 0.125,
        314: 0.125,
        315: 0.125,
        316: 0.125,
        317: 0.125,
        318: 0.125,
        319: 0.125,
        320: 0.125,
        321: 0.125,
        322: 0.125,
        323: 0.125,
        324: 0.125,
        325: 0.125,
        326: 0.166667,
        327: 0.166667,
        328: 0.166667,
        329: 0.125,
        330: 0.125,
        331: 0.125,
        332: 0.125,
        333: 0.125,
        334: 0.125,
        335: 0.125
    },
    maxStatFactor: {
        200: 35,
        201: 35.5,
        202: 36,
        203: 36.0909,
        204: 36.1818,
        205: 36.2727,
        206: 36.3636,
        207: 36.4545,
        208: 36.5455,
        209: 36.6364,
        210: 36.7273,
        211: 36.8182,
        212: 36.9091,
        213: 37,
        214: 37.1667,
        215: 37.3333,
        216: 37.5,
        217: 37.6667,
        218: 37.8333,
        219: 38,
        220: 38.2,
        221: 38.4,
        222: 38.6,
        223: 38.8,
        224: 39,
        225: 39.1667,
        226: 39.3333,
        227: 39.5,
        228: 39.6667,
        229: 39.8333,
        230: 40,
        231: 40.2,
        232: 40.4,
        233: 40.6,
        234: 40.8,
        235: 41,
        236: 41.2,
        237: 41.4,
        238: 41.6,
        239: 41.8,
        240: 42,
        241: 42.2,
        242: 42.4,
        243: 42.6,
        244: 42.8,
        245: 43,
        246: 43.1429,
        247: 43.2857,
        248: 43.4286,
        249: 43.5714,
        250: 43.7143,
        251: 43.8571,
        252: 44,
        253: 44.2,
        254: 44.4,
        255: 44.6,
        256: 44.8,
        257: 45,
        258: 45.1667,
        259: 45.3333,
        260: 45.5,
        261: 45.6667,
        262: 45.8333,
        263: 46,
        264: 46.2,
        265: 46.4,
        266: 46.6,
        267: 46.8,
        268: 47,
        269: 47.1667,
        270: 47.3333,
        271: 47.5,
        272: 47.6667,
        273: 47.8333,
        274: 48,
        275: 48.2,
        276: 48.4,
        277: 48.6,
        278: 48.8,
        279: 49,
        280: 49.1667,
        281: 49.3333,
        282: 49.5,
        283: 49.6667,
        284: 49.8333,
        285: 50,
        286: 50.2,
        287: 50.4,
        288: 50.6,
        289: 50.8,
        290: 51,
        291: 51.1667,
        292: 51.3333,
        293: 51.5,
        294: 51.6667,
        295: 51.8333,
        296: 52,
        297: 52.25,
        298: 52.5,
        299: 52.75,
        300: 53,
        301: 53.2,
        302: 53.4,
        303: 53.6,
        304: 53.8,
        305: 54,
        306: 54.25,
        307: 54.5,
        308: 54.75,
        309: 55,
        310: 55.25,
        311: 55.5,
        312: 55.75,
        313: 56,
        314: 56.25,
        315: 56.5,
        316: 56.75,
        317: 57,
        318: 57.25,
        319: 57.5,
        320: 57.75,
        321: 58,
        322: 58.25,
        323: 58.5,
        324: 58.75,
        325: 59,
        326: 59.3333,
        327: 59.6667,
        328: 60,
        329: 60.25,
        330: 60.5,
        331: 60.75,
        332: 61,
        333: 61.25,
        334: 61.5,
        335: 61.75
    }
};

tgd.calculateInfusedStats = function(initial_defense, initial_stat) {
    var finalStats = [];
    var target_defense = tgd.DestinyLightCap;
    if (initial_defense == target_defense || initial_defense < 200) return [initial_stat];
    var errorValueFinal = tgd.infusionStats.errorFactor[target_defense];
    var errorValueInitial = tgd.infusionStats.errorFactor[initial_defense];
    var maxStatValueInitial = tgd.infusionStats.maxStatFactor[initial_defense];
    var maxStatValueFinal = tgd.infusionStats.maxStatFactor[target_defense];
    var max_stat = Math.floor((maxStatValueFinal + errorValueFinal) / (maxStatValueInitial - errorValueInitial) * (initial_stat + 1.0));
    var min_stat = Math.floor((maxStatValueFinal - errorValueFinal) / (maxStatValueInitial + errorValueInitial) * initial_stat);
    finalStats.push(max_stat);
    if (min_stat !== max_stat) {
        finalStats.push(min_stat);
    }
    return finalStats;
};

tgd.bonusStatPoints = function(armorIndex, light) {
    if (armorIndex === 0) { //Helmet
        if (light < 291) {
            return 15;
        } else if (light < 307) {
            return 16;
        } else if (light < 319) {
            return 17;
        } else if (light < 332) {
            return 18;
        } else {
            return 19;
        }
    } else if (armorIndex === 1) { //Gauntlet
        if (light < 287) {
            return 13;
        } else if (light < 305) {
            return 14;
        } else if (light < 319) {
            return 15;
        } else if (light < 333) {
            return 16;
        } else {
            return 17;
        }
    } else if (armorIndex === 2) { //Chest
        if (light < 287) {
            return 20;
        } else if (light < 299) {
            return 21;
        } else if (light < 310) {
            return 22;
        } else if (light < 319) {
            return 23;
        } else if (light < 328) {
            return 24;
        } else {
            return 25;
        }
    } else if (armorIndex === 3) { //Boots
        if (light < 284) {
            return 18;
        } else if (light < 298) {
            return 19;
        } else if (light < 309) {
            return 20;
        } else if (light < 319) {
            return 21;
        } else if (light < 329) {
            return 22;
        } else {
            return 23;
        }
    } else if (armorIndex === 4) { //Class Items
        if (light < 295) {
            return 8;
        } else if (light < 319) {
            return 9;
        } else {
            return 10;
        }
    } else if (armorIndex === 5) { //Artifact
        if (light < 287) {
            return 34;
        } else if (light < 295) {
            return 35;
        } else if (light < 302) {
            return 36;
        } else if (light < 308) {
            return 37;
        } else if (light < 314) {
            return 38;
        } else if (light < 319) {
            return 39;
        } else if (light < 325) {
            return 40;
        } else if (light < 330) {
            return 41;
        } else {
            return 42;
        }
    } else if (armorIndex === 6) { //Ghost
        if (light < 295) {
            return 8;
        } else if (light < 319) {
            return 9;
        } else {
            return 10;
        }
    }
};